###############################################################################
# HTTP (port 80) vhosts for Webamp domains
#
# WHY THIS FILE EXISTS:
#   - Let’s Encrypt’s standard http-01 challenge requires each domain to be
#     reachable over plain HTTP on port 80.
#   - We intentionally DO NOT proxy any traffic here; these vhosts only exist
#     so Certbot can place and serve ACME challenge files.
#   - The real application traffic is served *only* on HTTPS (port 443), where
#     all reverse-proxying is configured.
#
# These vhosts expose nothing except a tiny placeholder DocumentRoot. Users who
# visit http://<domain> will see a benign placeholder page. HTTPS traffic is
# handled entirely in the corresponding :443 vhosts.
###############################################################################

<VirtualHost *:80>
    ServerName api.webamp.org
    ServerAlias api.webampskins.org
    ServerAdmin jordan@jordaneldredge.com

    DocumentRoot /var/www/webamp-placeholder
    ErrorLog ${APACHE_LOG_DIR}/api-http-error.log
    CustomLog ${APACHE_LOG_DIR}/api-http-access.log vhost_combined
RewriteEngine on
RewriteCond %{SERVER_NAME} =api.webamp.org [OR]
RewriteCond %{SERVER_NAME} =api.webampskins.org
RewriteRule ^ https://%{SERVER_NAME}%{REQUEST_URI} [END,NE,R=permanent]
</VirtualHost>

<VirtualHost *:80>
    ServerName skins.webamp.org
    ServerAdmin jordan@jordaneldredge.com

    DocumentRoot /var/www/webamp-placeholder
    ErrorLog ${APACHE_LOG_DIR}/skins-http-error.log
    CustomLog ${APACHE_LOG_DIR}/skins-http-access.log vhost_combined
RewriteEngine on
RewriteCond %{SERVER_NAME} =api.webampskins.org [OR]
RewriteCond %{SERVER_NAME} =api.webamp.org [OR]
RewriteCond %{SERVER_NAME} =skins.webamp.org
RewriteRule ^ https://%{SERVER_NAME}%{REQUEST_URI} [END,NE,R=permanent]
</VirtualHost>

<VirtualHost *:80>
    ServerName blue.api.webamp.org
    ServerAdmin jordan@jordaneldredge.com

    DocumentRoot /var/www/webamp-placeholder
    ErrorLog ${APACHE_LOG_DIR}/blue-api-http-error.log
    CustomLog ${APACHE_LOG_DIR}/blue-api-http-access.log vhost_combined
RewriteEngine on
RewriteCond %{SERVER_NAME} =blue.api.webamp.org [OR]
RewriteCond %{SERVER_NAME} =api.webampskins.org [OR]
RewriteCond %{SERVER_NAME} =api.webamp.org [OR]
RewriteCond %{SERVER_NAME} =skins.webamp.org
RewriteRule ^ https://%{SERVER_NAME}%{REQUEST_URI} [END,NE,R=permanent]
</VirtualHost>

<VirtualHost *:80>
    ServerName green.api.webamp.org
    ServerAdmin jordan@jordaneldredge.com

    DocumentRoot /var/www/webamp-placeholder
    ErrorLog ${APACHE_LOG_DIR}/green-api-http-error.log
    CustomLog ${APACHE_LOG_DIR}/green-api-http-access.log vhost_combined
RewriteEngine on
RewriteCond %{SERVER_NAME} =api.webamp.org [OR]
RewriteCond %{SERVER_NAME} =green.api.webamp.org [OR]
RewriteCond %{SERVER_NAME} =api.webampskins.org [OR]
RewriteCond %{SERVER_NAME} =blue.api.webamp.org [OR]
RewriteCond %{SERVER_NAME} =skins.webamp.org
RewriteRule ^ https://%{SERVER_NAME}%{REQUEST_URI} [END,NE,R=permanent]
</VirtualHost>
